summarise(
mean = mean(.data[[varname]], na.rm = TRUE),
sd   = sd(.data[[varname]], na.rm = TRUE),
.groups = "drop"
) %>%
rename(!!varname := mean)
}
# ===============================
# Run the function
# ===============================
d_summary <- data_summary(
data = tooth_data,
varname = "len",
groupnames = c("supp", "dose")
)
# Convert dose to factor
d_summary$dose <- as.factor(d_summary$dose)
# View output
print(d_summary)
# ===============================
# Bar plot with SD error bars
# ===============================
ggplot(d_summary, aes(x = dose, y = len, fill = supp)) +
geom_bar(stat = "identity", position = position_dodge()) +
geom_errorbar(
aes(ymin = len - sd, ymax = len + sd),
width = 0.2,
position = position_dodge(0.9)
) +
scale_fill_brewer(palette = "Paired") +
theme_minimal() +
labs(
title = "Mean Tooth Length by Supplement and Dose",
x = "Dose",
y = "Mean Tooth Length"
)
setwd("D:/R/Codes/R-for-Data-Science-and-Machine-Learning-with-NBICT-LAB-Batch-8/RDSML-Day-33 ðŸ‘‰ One Sample T Test")
ToothGrowth = ToothGrowth
data_summary <- function(data, varname, groupnames){
require(dplyr)
summary_func <- function(x, col){
c(mean = mean(x[[col]], na.rm=TRUE),
sd = sd(x[[col]], na.rm=TRUE))
}
data_sum <- ddply(data, groupnames, .fun=summary_func, varname)
data_sum <- rename(data_sum, c("mean" = varname))
return(data_sum)
}
d_summary <- data_summary(ToothGrowth, varname="len",
groupnames=c("supp", "dose"))
# ===============================
# Load required libraries
# ===============================
library(dplyr)
library(ggplot2)
# ===============================
# Load dataset
# ===============================
tooth_data <- ToothGrowth
# ===============================
# Create summary function (NO ddply)
# ===============================
data_summary <- function(data, varname, groupnames) {
data %>%
group_by(across(all_of(groupnames))) %>%
summarise(
mean = mean(.data[[varname]], na.rm = TRUE),
sd   = sd(.data[[varname]], na.rm = TRUE),
.groups = "drop"
) %>%
rename(!!varname := mean)
}
# ===============================
# Apply function
# ===============================
d_summary <- data_summary(
data = tooth_data,
varname = "len",
groupnames = c("supp", "dose")
)
# Convert dose to factor
d_summary$dose <- as.factor(d_summary$dose)
# View result
print(d_summary)
# ===============================
# Bar plot with SD error bars
# ===============================
ggplot(d_summary, aes(x = dose, y = len, fill = supp)) +
geom_bar(stat = "identity", position = position_dodge()) +
geom_errorbar(
aes(ymin = len - sd, ymax = len + sd),
width = 0.2,
position = position_dodge(0.9)
) +
scale_fill_brewer(palette = "Paired") +
theme_minimal() +
labs(
title = "Mean Tooth Length by Supplement and Dose",
x = "Dose",
y = "Mean Tooth Length"
)
setwd("D:/R/Codes/R-for-Data-Science-and-Machine-Learning-with-NBICT-LAB-Batch-8/RDSML-Day-36 ðŸ‘‰ Paired Samples T Test")
# Paired Samples T-Test in R
# Importing the dataset
myDataset <- read.csv("paired-samples-t-test.csv")
# Calculating the difference
diffs <- myDataset$carb - myDataset$carb_protein
# Checking if the differences are normally distributed
shapiro.test(diffs)
# Checking for outliers using boxplot
boxplot(diffs)
# Running the Paired T-Test
t.test(x = myDataset$carb,
y = myDataset$carb_protein,
paired = TRUE)
# Running the Wilcoxon signed-rank test
wilcox.test(x = myDataset$carb,
y = myDataset$carb_protein,
paired = TRUE)
# Calculating mean and sd
mean(myDataset$carb)
sd(myDataset$carb)
mean(myDataset$carb_protein)
sd(myDataset$carb_protein)
# Effect size calculation using Cohen's d
# 0.2 ~ small, 0.5 ~ medium, 0.8 ~ large
# install.packages("effsize")
library(effsize)
# Paired Samples T-Test in R
# Importing the dataset
myDataset <- read.csv("paired-samples-t-test.csv")
# Calculating the difference
diffs <- myDataset$carb - myDataset$carb_protein
# Checking if the differences are normally distributed
shapiro.test(diffs)
# Checking for outliers using boxplot
boxplot(diffs)
# Running the Paired T-Test
t.test(x = myDataset$carb,
y = myDataset$carb_protein,
paired = TRUE)
# Running the Wilcoxon signed-rank test
wilcox.test(x = myDataset$carb,
y = myDataset$carb_protein,
paired = TRUE)
# Calculating mean and sd
mean(myDataset$carb)
sd(myDataset$carb)
mean(myDataset$carb_protein)
sd(myDataset$carb_protein)
# Effect size calculation using Cohen's d
# 0.2 ~ small, 0.5 ~ medium, 0.8 ~ large
install.packages("effsize")
library(effsize)
cohen.d(myDataset$carb_protein, myDataset$carb, paired = T)
# A paired-samples t-test was used to determine whether there was a
# statistically significant mean difference between the distance ran
# when participants imbibed a carbohydrate-protein drink compared to
# a carbohydrate-only drink. No outliers were ditected. The assumption
# of normality was not violated, as assesed by Shipro-Wilk's test
# (p = 0.780). Participants ran further when imbibing the carbohydrate-
# protein drink (Mean = 11.302 KM, SD = 0.713 KM) as opposed to the
# carbohydrate only drink (Mean =  11.167 KM, SD = 0.726 KM), a
# statistically significant mean increase of 0.135 KM,
# 95% CI [0.091, 0.181], t(19) = 6.352, p < = .001, Cohen's d estimate: 0.187.
setwd("D:/R/Codes/R-for-Data-Science-and-Machine-Learning-with-NBICT-LAB-Batch-8/RDSML-Day-37 ðŸ‘‰ One-way ANOVA in R (Part-1)")
# One-way ANOVA
# Importing the dataset
PlantGrowth <- PlantGrowth
# importing the dplyr library
install.packages("dplyr")
library(dplyr)
# Computing the group means, sd, and se
stats <- PlantGrowth %>%
group_by(group) %>%
summarise(
mean = mean(weight),
sd = sd(weight),
se = sd(weight) / sqrt(n())
)
print(stats)
# Creating group wise box plots
boxplot(weight ~ group,
data = PlantGrowth,
main = "PlantGrowth data",
ylab = "Dried weight of plants",
col = "lightgray"
)
# Visualizing the data using mean plots
# install.packages("ggpubr")
library(ggpubr)
ggline(PlantGrowth,
x = "group",
y = "weight",
add = c("mean_se", "jitter")
)
# Running the One-way ANOVA test
anova <- aov(weight ~ group, data = PlantGrowth)
summary(anova)
setwd("D:/R/Codes/R-for-Data-Science-and-Machine-Learning-with-NBICT-LAB-Batch-8/RDSML-Day-38 ðŸ‘‰ One-way ANOVA in R (Part-2)")
# One-way ANOVA
# Importing the dataset
PlantGrowth <- PlantGrowth
# importing the dplyr library
install.packages("dplyr")
library(dplyr)
# Computing the group means, sd, and se
stats <- PlantGrowth %>%
group_by(group) %>%
summarise(
mean = mean(weight),
sd = sd(weight),
se = sd(weight) / sqrt(n())
)
print(stats)
# Creating group wise box plots
boxplot(weight ~ group,
data = PlantGrowth,
main = "PlantGrowth data",
ylab = "Dried weight of plants",
col = "lightgray"
)
# Visualizing the data using mean plots
# install.packages("ggpubr")
library(ggpubr)
ggline(PlantGrowth,
x = "group",
y = "weight",
add = c("mean_se", "jitter")
)
# Running the One-way ANOVA test
anova <- aov(weight ~ group, data = PlantGrowth)
summary(anova)
# Tukey multiple pairwise-comparisons
TukeyHSD(anova)
# Homogeneity of variances
plot(anova, 1)
library(car)
leveneTest(weight ~ group, data = PlantGrowth)
# ANOVA test with no assumption of equal variances
oneway.test(weight ~ group, data = PlantGrowth)
# Pairwise t-tests with no assumption of equal variances
pairwise.t.test(PlantGrowth$weight, PlantGrowth$group,
p.adjust.method = "BH", pool.sd = FALSE)
# Checking for normal distribution
plot(anova, 2)
# Extracting the residuals
aov_res <- residuals(object = anova)
# Running the Shapiro-Wilk test
shapiro.test(aov_res)
kruskal.test(weight ~ group, data = PlantGrowth)
pairwise.wilcox.test(PlantGrowth$weight, PlantGrowth$group,
p.adjust.method = "BH")
setwd("D:/R/Codes/R-for-Data-Science-and-Machine-Learning-with-NBICT-LAB-Batch-8/RDSML-Day-40 ðŸ‘‰ Two-way ANOVA in R (Part-2)")
installing Packages
# installing Packages
install.packages(c("tidyverse", "car", "emmeans", "effectsize", "performance", "broom", "kableExtra"))
library(tidyverse)
# Importing the dataset
d <- read.csv("cropdata.csv")
# Quick Exploratory Descriptive Analysis
summs <- d %>%
group_by(fert, irr) %>%
summarise(mean = mean(y), se = sd(y)/sqrt(n()), .groups = "drop")
# Quick Data Summary Visualization
library(ggplot2)
ggplot(summs, aes(irr, mean, group = fert))+
geom_line() +
geom_point(size = 2) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width = .2)+
facet_wrap(~fert, nrow = 1) +
labs(x="Irrigation", y="Mean yield",
title="Interaction of Fertilizer x Irrigation") +
theme_classic(base_size = 12)
# Fit the model
m <- aov(y ~ fert + irr + fert * irr, data = d)
summary(m)
# Assumptions visual checks
par(mfrow=c(2,2))
plot(m)
par(mfrow=c(1,1))
# Shapiro-Wilk on residuals (normality)
res <- residuals(m)
shapiro.test(res)
# Levene's test for equal variances
car::leveneTest(y ~ fert*irr, data = d, center = median)
# Interaction contrasts (simple effects):
# effect of fert at each level of irr
library(emmeans)
contrast(emmeans(m, ~ fert | irr), method = "pairwise", adjust = "tukey")
# effect of irr at each level of fert
library(emmeans)
contrast(emmeans(m, ~ irr | fert), method = "pairwise", adjust = "tukey")
setwd("D:/R/Codes/R-for-Data-Science-and-Machine-Learning-with-NBICT-LAB-Batch-8/RDSML-Day-41 ðŸ‘‰ Two-way ANOVA in R (Part-3)")
# installing Packages
# install.packages(c("tidyverse", "car", "emmeans", "effectsize", "performance", "broom", "kableExtra"))
library(tidyverse)
# Importing the dataset
d <- read.csv("cropdata.csv")
# Quick Exploratory Descriptive Analysis
summs <- d %>%
group_by(fert, irr) %>%
summarise(mean = mean(y), se = sd(y)/sqrt(n()), .groups = "drop")
# Quick Data Summary Visualization
library(ggplot2)
ggplot(summs, aes(irr, mean, group = fert))+
geom_line() +
geom_point(size = 2) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width = .2)+
facet_wrap(~fert, nrow = 1) +
labs(x="Irrigation", y="Mean yield",
title="Interaction of Fertilizer x Irrigation") +
theme_classic(base_size = 12)
# Fit the model
m <- aov(y ~ fert + irr + fert * irr, data = d)
summary(m)
# Assumptions visual checks
par(mfrow=c(2,2))
plot(m)
par(mfrow=c(1,1))
# Shapiro-Wilk on residuals (normality)
res <- residuals(m)
shapiro.test(res)
# Levene's test for equal variances
car::leveneTest(y ~ fert*irr, data = d, center = median)
# Interaction contrasts (simple effects):
# effect of fert at each level of irr
library(emmeans)
contrast(emmeans(m, ~ fert | irr), method = "pairwise", adjust = "tukey")
# effect of irr at each level of fert
library(emmeans)
contrast(emmeans(m, ~ irr | fert), method = "pairwise", adjust = "tukey")
# Main-effect comparisons (only if interaction is negligible)
contrast(emmeans(m, ~fert), method = "tukey")
contrast(emmeans(m, ~irr), method = "tukey")
# CLD letters
library(multcomp)
# installing Packages
# install.packages(c("tidyverse", "car", "emmeans", "effectsize", "performance", "broom", "kableExtra"))
library(tidyverse)
# Importing the dataset
d <- read.csv("cropdata.csv")
# Quick Exploratory Descriptive Analysis
summs <- d %>%
group_by(fert, irr) %>%
summarise(mean = mean(y), se = sd(y)/sqrt(n()), .groups = "drop")
# Quick Data Summary Visualization
library(ggplot2)
ggplot(summs, aes(irr, mean, group = fert))+
geom_line() +
geom_point(size = 2) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width = .2)+
facet_wrap(~fert, nrow = 1) +
labs(x="Irrigation", y="Mean yield",
title="Interaction of Fertilizer x Irrigation") +
theme_classic(base_size = 12)
# Fit the model
m <- aov(y ~ fert + irr + fert * irr, data = d)
summary(m)
# Assumptions visual checks
par(mfrow=c(2,2))
plot(m)
par(mfrow=c(1,1))
# Shapiro-Wilk on residuals (normality)
res <- residuals(m)
shapiro.test(res)
# Levene's test for equal variances
car::leveneTest(y ~ fert*irr, data = d, center = median)
# Interaction contrasts (simple effects):
# effect of fert at each level of irr
library(emmeans)
contrast(emmeans(m, ~ fert | irr), method = "pairwise", adjust = "tukey")
# effect of irr at each level of fert
library(emmeans)
contrast(emmeans(m, ~ irr | fert), method = "pairwise", adjust = "tukey")
# Main-effect comparisons (only if interaction is negligible)
contrast(emmeans(m, ~fert), method = "tukey")
contrast(emmeans(m, ~irr), method = "tukey")
# CLD letters
library(multcomp)
# installing Packages
# install.packages(c("tidyverse", "car", "emmeans", "effectsize", "performance", "broom", "kableExtra"))
library(tidyverse)
# Importing the dataset
d <- read.csv("cropdata.csv")
# Quick Exploratory Descriptive Analysis
summs <- d %>%
group_by(fert, irr) %>%
summarise(mean = mean(y), se = sd(y)/sqrt(n()), .groups = "drop")
# Quick Data Summary Visualization
library(ggplot2)
ggplot(summs, aes(irr, mean, group = fert))+
geom_line() +
geom_point(size = 2) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width = .2)+
facet_wrap(~fert, nrow = 1) +
labs(x="Irrigation", y="Mean yield",
title="Interaction of Fertilizer x Irrigation") +
theme_classic(base_size = 12)
# Fit the model
m <- aov(y ~ fert + irr + fert * irr, data = d)
summary(m)
# Assumptions visual checks
par(mfrow=c(2,2))
plot(m)
par(mfrow=c(1,1))
# Shapiro-Wilk on residuals (normality)
res <- residuals(m)
shapiro.test(res)
# Levene's test for equal variances
car::leveneTest(y ~ fert*irr, data = d, center = median)
# Interaction contrasts (simple effects):
# effect of fert at each level of irr
library(emmeans)
contrast(emmeans(m, ~ fert | irr), method = "pairwise", adjust = "tukey")
# effect of irr at each level of fert
library(emmeans)
contrast(emmeans(m, ~ irr | fert), method = "pairwise", adjust = "tukey")
# Main-effect comparisons (only if interaction is negligible)
contrast(emmeans(m, ~fert), method = "tukey")
contrast(emmeans(m, ~irr), method = "tukey")
# CLD letters
library(multcomp)
# installing Packages
# install.packages(c("tidyverse", "car", "emmeans", "effectsize", "performance", "broom", "kableExtra"))
library(tidyverse)
# Importing the dataset
d <- read.csv("cropdata.csv")
# Quick Exploratory Descriptive Analysis
summs <- d %>%
group_by(fert, irr) %>%
summarise(mean = mean(y), se = sd(y)/sqrt(n()), .groups = "drop")
# Quick Data Summary Visualization
library(ggplot2)
ggplot(summs, aes(irr, mean, group = fert))+
geom_line() +
geom_point(size = 2) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width = .2)+
facet_wrap(~fert, nrow = 1) +
labs(x="Irrigation", y="Mean yield",
title="Interaction of Fertilizer x Irrigation") +
theme_classic(base_size = 12)
# Fit the model
m <- aov(y ~ fert + irr + fert * irr, data = d)
summary(m)
# Assumptions visual checks
par(mfrow=c(2,2))
plot(m)
par(mfrow=c(1,1))
# Shapiro-Wilk on residuals (normality)
res <- residuals(m)
shapiro.test(res)
# Levene's test for equal variances
car::leveneTest(y ~ fert*irr, data = d, center = median)
# Interaction contrasts (simple effects):
# effect of fert at each level of irr
library(emmeans)
contrast(emmeans(m, ~ fert | irr), method = "pairwise", adjust = "tukey")
# effect of irr at each level of fert
library(emmeans)
contrast(emmeans(m, ~ irr | fert), method = "pairwise", adjust = "tukey")
# Main-effect comparisons (only if interaction is negligible)
contrast(emmeans(m, ~fert), method = "tukey")
contrast(emmeans(m, ~irr), method = "tukey")
# CLD letters
library(multcomp)
setwd("D:/R/Codes/R-for-Data-Science-and-Machine-Learning-with-NBICT-LAB-Batch-8/RDSML-Day-42 ðŸ‘‰ Two-way ANOVA in R (Part-4)")
# installing Packages
install.packages(c("tidyverse", "car", "emmeans", "effectsize", "performance", "broom", "kableExtra"))
library(tidyverse)
# Importing the dataset
d <- read.csv("cropdata.csv")
# Quick Exploratory Descriptive Analysis
summs <- d %>%
group_by(fert, irr) %>%
summarise(mean = mean(y), se = sd(y)/sqrt(n()), .groups = "drop")
print(summs)
# Quick Data Summary Visualization
library(ggplot2)
ggplot(summs, aes(irr, mean, group = fert))+
geom_line() +
geom_point(size = 2) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width = .2)+
facet_wrap(~fert, nrow = 1) +
labs(x="Irrigation", y="Mean yield",
title="Interaction of Fertilizer x Irrigation") +
theme_classic(base_size = 12)
# Fit the model
m <- aov(y ~ fert + irr + fert * irr, data = d)
summary(m)
# Assumptions visual checks
par(mfrow=c(2,2))
plot(m)
par(mfrow=c(1,1))
# Shapiro-Wilk on residuals (normality)
res <- residuals(m)
shapiro.test(res)
# Levene's test for equal variances
library(car)
leveneTest(y ~ fert*irr, data = d, center = median)
# Interaction contrasts (simple effects):
# effect of fert at each level of irr
library(emmeans)
contrast(emmeans(m, ~ fert | irr), method = "pairwise", adjust = "tukey")
# effect of irr at each level of fert
library(emmeans)
contrast(emmeans(m, ~ irr | fert), method = "pairwise", adjust = "tukey")
# Main-effect comparisons (only if interaction is negligible)
contrast(emmeans(m, ~fert), method = "tukey")
contrast(emmeans(m, ~irr), method = "tukey")
# CLD letters
library(multcomp)
